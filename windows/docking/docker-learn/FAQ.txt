Docker: The Basics
Frequently Asked Questions

Q: I can't use the nano editor on Windows
A: You'll need to install another plaintext editor, such as Vim, which is available at http://www.vim.org/download.php#pc.

###########################
# installation on windows
###########################
1. Install chocolatey
2. in admin power shell>choco install docker-desktop --pre


###################################
# frequent commands
###################################
docker ps -a
# all

docker -ps -l
# last command

docker images

docker run -ti ubuntu:latest bash
# ti  terminal interactive

docker stop f6b68415ac9f
# stop a running images

docker commit f6b68415ac9f
# save it to new image. Returns new image

docker tag dd090e705d858e70c0772986b21a9f3803f0bc69980ad1bea6abb303dbce4b88 mybuntu
# now the committed image is tagged to a logical name

docker commit myubuntu anotherubuntu
# is commit and tag together

docker run --rm -ti ubuntu sleep 5
# create and delete the container

docker run --rm -ti ubuntu bash -c "echo hello; sleep 2; echo world"
# run multiple bash commands

docker run -d -ti bash
# detached aka run in the background

docker attach <put the auto name generated by the docker>
# attach and work again

docker exec -ti relaxed_raman echo "hello world"
# add commands to the bg running docker

docker rmi -f hello-world
# docker remove images

 docker run --name vatsap -d -ti bash
 # can control the names with --name

 docker logs vatsap
 # shows the terminal output log

 docker kill vatsap
 # to stop the container. same as stop

# tips
* container dependency should not be fetch when it starts
* name all your containers atleast the important ones


# networking
# cmd1
 docker run --rm  -ti -p 45678:45678  -p 45690:45690  --name serve ubuntu:14.04  bash
 # 14.04 has nc, a network command in it
 bash> nc -lp 45678 | nc -lp 45690

# cmd2
docker run --rm ubuntu:14.04 bash
bash>nc host.docker.internal 45678
I am a master

# cmd3
docker run --rm -ti ubuntu:14.04 bash
bash>nc host.docker.internal 45690
I am a master
I am a slave

# cmd 4
docker port serve
45678/tcp -> 0.0.0.0:45678
45690/tcp -> 0.0.0.0:45690
# multiple dynamic ports can be done just usinr -p 45678 that allows docker to chose a port.


# docker vitrual network features

# cmd1
docker network ls
docker network create learning
docker run --rm -ti --net learning --name cat ubuntu:14.04 bash
bash>ping cat

# cmd2
docker run --rm -ti --net learning --name dog ubuntu:14.04 bash
bash>ping dog
bash>ping cat

# cmd1
bash>nc -lp 123 # any port number actually
I am a master from Cat
No you are not! from Dog

# cmd2
bash>nc cat 123 # same port of the cat
I am a master from Cat
No you are not! from Dog

# cmd3 ; a new on terminal
docker network ls
# should see learning
docker network create 4cats
docker network connect 4cats cat
# connected cat server to 4cats
docker run --rm -ti --net 4cats --name tiger ubuntu:14.04 bash
bash>ping cat # works
bash>ping tiger # works
bash>ping dog # doesn't work

# docker images is very space efficient
docker commit exciting_ritchie  fulltag.com:8080/myorg/ubuntu:14

# about volumes (shared folders b/w contains or/and host). Not part of images

#persistant b/w host and container
docker run -ti -v \path\docker-learn\shared_folder:/shared_name ubuntu bash

# ephemeral between containers
# cmd1
docker run -ti -v /shared-volume ubuntu bash
bash>echo "some data to share with another container" > /shared-volume/shared_data_file.txt

# cmd2
docker run -ti --volumes-from zealous_shirley ubuntu bash
bash>ls shared_volume/
# we see the shared_data_file.txt
bash?echo `uname -a` > shared-volume/from_another_container.txt
# now the folder remains even if we exit cmd1 container!
# if we n ow exit even cmd 2, the shared_volume/ is gone!!


# docker registry
### we can keep image registry within companies also use it globally
docker search ubuntu
# same search can be done on hub.docker.com

docker login
# give username and password
docker pull bash
docker tag bash vatsamail/bash-test:1.0
docker push vatsamail/bash-test:1.0
docker search bash-test


# Tip: docker expose?
docker run -i --expose=22 expert_vatsa bash

# Tip: port exposer
docker run -p 8080:80



################# dockerfile
docker build -t <tag> <location to the dockerfile>
# it is line by line
# each step is cached (if nothing changed it will "skip")
# they are NOT shell scripts
# each line is a own docker run

>docker build -t hello .
# Refer Dockerfile



########## docker syntax
FROM java:8
MAINTAINER First LastName <email@email.com>
RUN <commands and parameters>
ADD run.sh /run.sh
ADD project.tare.gz /install/
ADD https://google.com/someinga.jpeg /project/
ENV DB_HOST=db.prod
ENV DB_PORT-1234
ENTRYPOINT ls
# specifies that this is the starting point to run
CMD <who command executes>
EXPOSE 8080
# match port to the container
VOLUME ["" ""] or VOLUME [""]
WORKDIR <sets the directory for the reminder of the docker directory>
WORKDIR /install/
USER vatsamail
# Reference: https://docs.docker.com/develop/develop-images/dockerfile_best-practices/

##### docker constraints with mem, ram, exectime etc.
